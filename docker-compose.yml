services:
  recommender-dev:
    build:
      context: .
      dockerfile: Dockerfile
    image: recommender-systems:latest
    container_name: recommender-systems-dev
    volumes:
      # Mount the project directory for live development
      - .:/workspace
      # Persist conda packages (optional, for faster rebuilds)
      - conda-packages:/opt/conda/pkgs
    working_dir: /workspace
    # Enable GPU support
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    # Keep container running
    stdin_open: true
    tty: true
    # Set environment variables
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
    # Default command
    command: /bin/bash

volumes:
  conda-packages:
